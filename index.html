<!DOCTYPE html>
<html lang="en">

<head>
    <script type="module">
        import { randomize, buffer, WIDTH, iterate, ALIVE, DEAD, setWorld, getAsString, setWorldSize } from "./build/release.js";
        // window.addEventListener("load", (ev) => {
        const canvas = document.querySelector("#canvas");
        const div = document.querySelector("div:has(pre)");

        window.addEventListener("keyup", (ev) => {
            iterate();
        });

        let lastRun = 0;

        const loop = (ts) => {
            if (Date.now() > lastRun + 50) {

                iterate();
                lastRun = Date.now();
                canvas.innerText = getAsString();
            }
            requestAnimationFrame(loop);
        }

        //randomize();
        //setTimeout(() => {
            /*let newWorld = new Uint8Array(63 * 64).map((v, i) => {
                //console.log(i & 1);
                return (i & 1) ? ALIVE : DEAD;
            });

            console.log(newWorld);
            
            setWorld(newWorld);*/
            //}, 10000);
            setWorldSize(63, 64);
            randomize();
        requestAnimationFrame(loop);
    </script>

    <style>
        body {
            display: flex;
            justify-content: center;
            align-content: center;
            background-color: black;
            color: white;
        }
        #canvas {
            display: inline-block;
        }

        h1 {
            text-align: center;
        }
    </style>
</head>

<body>
    <div>

        <h1>Game of Life</h1>
        <pre id="canvas">
            
        </pre>
    </div>
</body>

</html>